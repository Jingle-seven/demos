### Java 实现简单聊天室  
用Java实现一个简单的多人聊天室，效果如下：

![Java 实现简单聊天室 - 便利贴 - 便利贴墙](https://github.com/Jingle-seven/demos/blob/master/support/article/img/6631237090489855574.jpg)
 
![Java 实现简单聊天室 - 便利贴 - 便利贴墙](https://github.com/Jingle-seven/demos/blob/master/support/article/img/6631398718699137255.jpg)

主要逻辑思路：

服务端实现多线程接收来自客户端的连接，客户端除了主线程外，还使用另一个线程单独更新聊天框内容。

具体实现：

服务端定义静态内部线程类，初始化ServerSocket、输入输出流、在主方法中用ServerSocket 的accept()方法等待客户端连接。
客户端输入姓名和内容，点击发送按钮后连接到服务端，并向服务端发送一条姓名以及一条信息。同时主线程循环等待输入，另一个线程等待从服务端发来的广播信息，更新到聊天框。
服务端启动一个新线程响应客户端连接，循环等待输入，并将Socket加入list容器，接收客户端发送的姓名和信息，调用定义的sendMessage()方法向所有客户端广播信息。

服务端代码如下，其中蓝色为手写代码，黑色为机器自动生成代码。
```
import java.io.*;
import java.net.*;
import java.util.*;


/**
 *
 * @author  __USER__
 */
public class ServerFrame extends javax.swing.JFrame {

	public static List<Socket> list = new ArrayList<Socket>();
	
	/** Creates new form ServerFrame */
	public ServerFrame() {
		initComponents();
	}

	/** This method is called from within the constructor to
	 * initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is
	 * always regenerated by the Form Editor.
	 */
	//GEN-BEGIN:initComponents
	// <editor-fold defaultstate="collapsed" desc="Generated Code">
	private void initComponents() {

		jScrollPane1 = new javax.swing.JScrollPane();
		ta1 = new javax.swing.JTextArea();

		setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

		ta1.setColumns(20);
		ta1.setRows(5);
		ta1.append("服务端启动\n");
		jScrollPane1.setViewportView(ta1);

		javax.swing.GroupLayout layout = new javax.swing.GroupLayout(
				getContentPane());
		getContentPane().setLayout(layout);
		layout.setHorizontalGroup(layout.createParallelGroup(
				javax.swing.GroupLayout.Alignment.LEADING).addGroup(
				layout.createSequentialGroup()
						.addContainerGap()
						.addComponent(jScrollPane1,
								javax.swing.GroupLayout.DEFAULT_SIZE, 372,
								Short.MAX_VALUE).addContainerGap()));
		layout.setVerticalGroup(layout.createParallelGroup(
				javax.swing.GroupLayout.Alignment.LEADING).addGroup(
				layout.createSequentialGroup()
						.addContainerGap()
						.addComponent(jScrollPane1,
								javax.swing.GroupLayout.DEFAULT_SIZE, 272,
								Short.MAX_VALUE).addContainerGap()));

		pack();
	}// </editor-fold>
	//GEN-END:initComponents

	/**
	 * @param args the command line arguments
	 */
	public static void main(String args[]) {
		java.awt.EventQueue.invokeLater(new Runnable() {
			public void run() {
				new ServerFrame().setVisible(true);
			}
		});
		//主方法
		ServerSocket ss = null;
		Socket s = null;
		try {
			ss = new ServerSocket (11111);
			while(true){
				//不间断接收socket，启动新线程
				s = ss.accept();
				list.add(s);
				Thread t = new Thread(new Mysever(s));
				t.start();
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	//GEN-BEGIN:variables
	// Variables declaration - do not modify
	private javax.swing.JScrollPane jScrollPane1;
	public static javax.swing.JTextArea ta1;
	// End of variables declaration//GEN-END:variables
	
	//静态内部类实现端口线程
	static class Mysever implements Runnable{
		ServerSocket sersoc =  null;
		Socket  soc = null;
		DataInputStream dis = null;
		DataOutputStream dos = null;
		int port = 11111;
		
		//无参构造函数
		public Mysever() {}
		//构造函数传入Socket参数
		public Mysever(Socket s){
			this.soc = s;
		}
		
		//遍历所有线程发送信息的方法
		public void  sendMessage(String msg){
			for (Socket x : list) {
				 try {
					dos = new DataOutputStream(x.getOutputStream());
					dos.writeUTF(msg);
					dos.flush();
				} catch (IOException e) {
					e.printStackTrace();
				}
			}
		}
		public void run(){
			try {
				dis = new DataInputStream(soc.getInputStream());
				dos = new DataOutputStream(soc.getOutputStream());
				
				ta1.append(Thread.currentThread().getName()+" 连接\n");
				//第一次首先接收客户端传送的用户姓名，设置为线程名
				 Thread.currentThread().setName(dis.readUTF());
				 sendMessage("欢迎 "+Thread.currentThread().getName()+" 来到群聊");
				 
				while(true){
					//循环读取用户发送的信息
					String s = dis.readUTF();
					
					//调用sendMessage方法向所有客户端发送刚刚读取到的信息
					sendMessage(Thread.currentThread().getName()+": "+s);
					ta1.append(Thread.currentThread().getName()+" 发送信息: "+s+"\n");
				}
				
			} catch (Exception e) {
				e.printStackTrace();
				ta1.append(Thread.currentThread().getName()+" 断开了连接\n");
				
			}finally{
				try {
					dis.close();
					dos.close();
				} catch (IOException e) {
					e.printStackTrace();
				}
			}
			
		}
	}
}
```
客户端代码如下：
```
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.Socket;
import java.net.UnknownHostException;
import java.util.Scanner;

/**
 * @author  __USER__
 */
public class ClientFrame extends javax.swing.JFrame {

	static String name;
	String msg;
	int port = 11111;
	String host = "127.0.0.1";
	Socket soc = null;
	DataInputStream dis = null;
	DataOutputStream dos = null;
	boolean flag = true ;//用来决定是否发送名字的开关

	public ClientFrame() {
		initComponents();
		
		//初始化输入输出流
		try {
			soc = new Socket(this.host, this.port);
			dis = new DataInputStream(soc.getInputStream());
			dos = new DataOutputStream(soc.getOutputStream());
		} catch (UnknownHostException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
		//单独建立一个线程用来更新文本域
		Thread t = new MyThread();
		t.start();

	}

	/** This method is called from within the constructor to
	 * initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is
	 * always regenerated by the Form Editor.
	 */
	//GEN-BEGIN:initComponents
	// <editor-fold defaultstate="collapsed" desc="Generated Code">
	private void initComponents() {

		jScrollPane1 = new javax.swing.JScrollPane();
		ta1 = new javax.swing.JTextArea();
		jScrollPane2 = new javax.swing.JScrollPane();
		ta2 = new javax.swing.JTextArea();
		bt1 = new javax.swing.JButton();
		bt2 = new javax.swing.JButton();
		jLabel1 = new javax.swing.JLabel();
		tx1 = new javax.swing.JTextField();

		setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

		ta1.setColumns(20);
		ta1.setRows(5);
		jScrollPane1.setViewportView(ta1);

		ta2.setColumns(20);
		ta2.setRows(5);
		jScrollPane2.setViewportView(ta2);

		bt1.setText("\u6e05\u7a7a");
		bt1.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				bt1ActionPerformed(evt);
			}
		});

		bt2.setText("\u53d1\u9001");
		bt2.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				bt2ActionPerformed(evt);
			}
		});

		jLabel1.setText("\u59d3\u540d\uff1a");

		tx1.setText("\u8bf7\u5148\u8f93\u5165\u59d3\u540d");

		javax.swing.GroupLayout layout = new javax.swing.GroupLayout(
				getContentPane());
		getContentPane().setLayout(layout);
		layout.setHorizontalGroup(layout
				.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
				.addGroup(
						layout.createSequentialGroup()
								.addContainerGap()
								.addGroup(
										layout.createParallelGroup(
												javax.swing.GroupLayout.Alignment.LEADING)
												.addGroup(
														layout.createParallelGroup(
																javax.swing.GroupLayout.Alignment.TRAILING,
																false)
																.addComponent(
																		jScrollPane1,
																		javax.swing.GroupLayout.Alignment.LEADING)
																.addGroup(
																		javax.swing.GroupLayout.Alignment.LEADING,
																		layout.createSequentialGroup()
																				.addComponent(
																						jScrollPane2,
																						javax.swing.GroupLayout.PREFERRED_SIZE,
																						289,
																						javax.swing.GroupLayout.PREFERRED_SIZE)
																				.addPreferredGap(
																						javax.swing.LayoutStyle.ComponentPlacement.RELATED)
																				.addGroup(
																						layout.createParallelGroup(
																								javax.swing.GroupLayout.Alignment.LEADING)
																								.addComponent(
																										bt1)
																								.addComponent(
																										bt2))))
												.addGroup(
														layout.createSequentialGroup()
																.addComponent(
																		jLabel1)
																.addPreferredGap(
																		javax.swing.LayoutStyle.ComponentPlacement.RELATED)
																.addComponent(
																		tx1,
																		javax.swing.GroupLayout.PREFERRED_SIZE,
																		javax.swing.GroupLayout.DEFAULT_SIZE,
																		javax.swing.GroupLayout.PREFERRED_SIZE)))
								.addContainerGap(
										javax.swing.GroupLayout.DEFAULT_SIZE,
										Short.MAX_VALUE)));
		layout.setVerticalGroup(layout
				.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
				.addGroup(
						layout.createSequentialGroup()
								.addGap(12, 12, 12)
								.addGroup(
										layout.createParallelGroup(
												javax.swing.GroupLayout.Alignment.BASELINE)
												.addComponent(jLabel1)
												.addComponent(
														tx1,
														javax.swing.GroupLayout.PREFERRED_SIZE,
														javax.swing.GroupLayout.DEFAULT_SIZE,
														javax.swing.GroupLayout.PREFERRED_SIZE))
								.addPreferredGap(
										javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
								.addComponent(jScrollPane1,
										javax.swing.GroupLayout.PREFERRED_SIZE,
										197,
										javax.swing.GroupLayout.PREFERRED_SIZE)
								.addPreferredGap(
										javax.swing.LayoutStyle.ComponentPlacement.RELATED)
								.addGroup(
										layout.createParallelGroup(
												javax.swing.GroupLayout.Alignment.LEADING,
												false)
												.addGroup(
														javax.swing.GroupLayout.Alignment.TRAILING,
														layout.createSequentialGroup()
																.addComponent(
																		bt1)
																.addPreferredGap(
																		javax.swing.LayoutStyle.ComponentPlacement.RELATED,
																		javax.swing.GroupLayout.DEFAULT_SIZE,
																		Short.MAX_VALUE)
																.addComponent(
																		bt2))
												.addComponent(
														jScrollPane2,
														javax.swing.GroupLayout.PREFERRED_SIZE,
														62,
														javax.swing.GroupLayout.PREFERRED_SIZE))
								.addGap(14, 14, 14)));

		pack();
	}// </editor-fold>
	//GEN-END:initComponents

	private void bt1ActionPerformed(java.awt.event.ActionEvent evt) {
		ta2.setText("");
	}

	private void bt2ActionPerformed(java.awt.event.ActionEvent evt) {
		msg = ta2.getText();
		name = tx1.getText();
		if (name.equals("请先输入姓名")) {
			ta2.setText("请先输入姓名");
		} else {
			try {
				if(flag){
					dos.writeUTF(name);//第一次先将名字传输到服务器
					flag = false;
				}
				dos.writeUTF(msg);//传输聊天框内容
				ta2.setText("");

			} catch (IOException e) {
				e.printStackTrace();
			}
		}

	}

	/**
	 * @param args the command line arguments
	 */
	public static void main(String args[]) {
		java.awt.EventQueue.invokeLater(new Runnable() {
			public void run() {
				new ClientFrame().setVisible(true);
			}
		});
	}

	//GEN-BEGIN:variables
	// Variables declaration - do not modify
	private javax.swing.JButton bt1;
	private javax.swing.JButton bt2;
	private javax.swing.JLabel jLabel1;
	private javax.swing.JScrollPane jScrollPane1;
	private javax.swing.JScrollPane jScrollPane2;
	private javax.swing.JTextArea ta1;
	private javax.swing.JTextArea ta2;
	private javax.swing.JTextField tx1;

	// End of variables declaration//GEN-END:variables
	
	//定义一个线程类用来单独更新文本域
	class MyThread extends Thread {
		public void run() {
			while (true) {
				try {
					ta1.append(dis.readUTF() + "\n");
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		}
	}
}
```
其中有不足之处还请多加指出~